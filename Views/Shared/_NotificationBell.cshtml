@* Views/Shared/_NotificationBell.cshtml *@
@* Component للإشعارات يمكن استخدامه في أي صفحة *@

@if (User.Identity.IsAuthenticated)
{
    <div class="notification-bell-container">
        <a class="notification-bell-link position-relative" href="#" 
           id="notificationDropdown" 
           data-bs-toggle="dropdown" 
           aria-expanded="false"
           title="الإشعارات">
            <i class="fas fa-bell fa-lg"></i>
            <span id="notification-badge" 
                  class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                  style="display: none; font-size: 0.7rem; padding: 0.25em 0.5em;">
                0
            </span>
        </a>

        <div class="dropdown-menu dropdown-menu-end shadow-lg notification-dropdown" 
             aria-labelledby="notificationDropdown"
             style="width: 380px; max-height: 500px;">
            
            <!-- Header -->
            <div class="dropdown-header d-flex justify-content-between align-items-center px-3 py-2 border-bottom">
                <div>
                    <i class="fas fa-bell text-primary"></i>
                    <strong>الإشعارات</strong>
                </div>
                <div>
                    <a href="@Url.Action("Index", "Notifications")" 
                       class="btn btn-sm btn-link text-decoration-none">
                        عرض الكل
                    </a>
                </div>
            </div>

            <!-- Notification List -->
            <div id="notification-list" style="max-height: 350px; overflow-y: auto;">
                <div class="text-center p-4 text-muted">
                    <i class="fas fa-spinner fa-spin fa-2x mb-2"></i>
                    <p class="mb-0">جاري تحميل الإشعارات...</p>
                </div>
            </div>

            <!-- Footer -->
            <div class="dropdown-divider m-0"></div>
            <div class="text-center py-2">
                <button onclick="notificationManager.markAllAsRead()" 
                        class="btn btn-sm btn-outline-primary">
                    <i class="fas fa-check-double"></i> تحديد الكل كمقروء
                </button>
            </div>
        </div>
    </div>

    <style>
        .notification-bell-link {
            color: inherit;
            text-decoration: none;
            display: inline-block;
            padding: 0.5rem;
            transition: all 0.3s ease;
        }

        .notification-bell-link:hover {
            color: var(--bs-primary);
            transform: scale(1.1);
        }

        .notification-dropdown {
            border-radius: 12px;
            border: none;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15) !important;
        }

        .notification-dropdown .dropdown-header {
            background-color: #f8f9fa;
            font-weight: 600;
        }

        #notification-list::-webkit-scrollbar {
            width: 8px;
        }

        #notification-list::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        #notification-list::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        #notification-list::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        @@media (max-width: 576px) {
            .notification-dropdown {
                width: 100vw !important;
                max-width: 100vw !important;
                left: 0 !important;
                right: 0 !important;
                margin: 0 !important;
                border-radius: 0 !important;
                position: fixed !important;
                top: auto !important;
                bottom: 0 !important;
                max-height: 70vh !important;
            }

            #notification-list {
                max-height: calc(70vh - 120px) !important;
            }
        }
    </style>
}
